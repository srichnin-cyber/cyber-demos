templateId: plan-comparison-two-row
description: Plan comparison with two-line header (plan name above group name)

# Server-side transformer will build a comparisonMatrix where the first two rows
# are header rows: row 0 contains the primary plan names, row 1 contains the
# group names. Rows 2+ are benefit rows. The controller/composer should inject
# this matrix into `data.comparisonMatrix` before rendering (see PlanComparisonTransformer usage).

config:
  # spacing between plan columns (empty columns inserted before each plan)
  # Use 1 for single column spacing (cleaner look)
  columnSpacing: 1
  # Enable two-row header: plan name in row 1, group name in row 2
  twoRowHeader: true
  # Field name on each plan object that contains the group name
  groupField: group

sections:
  - sectionId: plan_comparison_two_row
    type: EXCEL
    templatePath: comparison-template.xlsx
    mappingType: JSONPATH
    fieldMappings:
      # With columnSpacing: 1 and 2 plans:
      # Total columns = 1 + 2*(1+1) = 5
      # Range A1:G8 covers 2 header rows + up to 6 data rows
      "A1:G8": "$.comparisonMatrix"

# Example: server-side code (pseudocode) to produce `comparisonMatrix`:
#
# List<List<Object>> header1 = buildPrimaryHeader(plans, columnSpacing);
# List<List<Object>> header2 = buildGroupHeader(plans, columnSpacing);
# List<List<Object>> body = PlanComparisonTransformer.transformPlansToMatrix(plans, "name", "value", columnSpacing, 0);
# // drop the transformer's generated single header row and prepend our two header rows
# List<List<Object>> full = new ArrayList<>();
# full.add(header1);
# full.add(header2);
# full.addAll(body.subList(1, body.size()));
# data.put("comparisonMatrix", full);
